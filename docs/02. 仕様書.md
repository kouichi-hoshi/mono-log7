---
title: 02. 仕様書
source:
author:
  -
published:
created: 2025-11-25
description:
tags:
---
## アプリ名

名称: Mono Log（モノローグ）
keyなど: mono-log

## コンセプト

- メモ+TODOリスト
- 軽くて早い
- ストックよりもフロー
- タイムライン方式

## 要件サマリ

- PC用webブラウザ、及びスマフォ用webブラウザで利用することを前提とするwebアプリ
- ユーザーは、日々のメモとTODOを区別しすぎずに、ひとつのタイムライン上に時系列で記録・閲覧できること。
- 投稿が増えても、タイムラインをスクロールする操作がストレスなく行えること。
- メモ／TODOの違いは、タイムライン上での絞り込み（カテゴリ切り替え）で簡単に切り替えられること。
- 不要になった投稿はすぐに完全削除せず、一度ゴミ箱に入れておき、後からまとめて整理・削除できること。
- ログイン後は、1ページ内（画面遷移なし）で「投稿の作成・編集・削除・閲覧」が完結すること。
- 認証や通信エラーが発生した場合も、ユーザーが現在の状態と次の行動を理解できるよう、適切なフィードバック（トーストやダイアログ）が表示されること。

## アーキテクチャ

- SPA的なWebアプリ
- RDB（PostgreSQL）を前提とする

## ページ構造

- 1ページのみ、ページ遷移無し
- レイアウト
    - 下記を基本構造とする
        - ヘッダーコンポーネント
        - メインコンポーネント
        - フッターコンポーネント

## ログイン判定

- ミドルウェア層でログイン状態をセッションで判定する
    - 未ログイン: 未ログイン画面を表示
    - ログイン中: ログイン中画面を表示

## ログイン状態別画面仕様

### 未ログイン時 

- レイアウト
    - ヘッダー
	    -  左上にアプリ名を表示する
	    - 右上に「ログイン」ボタンを表示する
    - メイン
	    - ウェルカムメッセージを表示する
	    - ウェルカムメッセージの近くに「ログイン」ボタンを表示する
    - フッター
	    - （コピーライトや外部リンクなどの情報のみを表示し、投稿一覧の絞り込みや「ゴミ箱を見る」リンクは含まない）

### ログイン中

- レイアウト
	- ヘッダー
	    - ユーザーアイコンを表示する
	- メイン
	    - デフォルト
			- 上側にエディタを固定表示する
			- 下側に投稿一覧を表示する
	    - 画面幅がmd以上
	        - 左側にエディタを固定表示する
	        - 右側に投稿一覧を表示する
		    - 画面をスクロールしてもエディタは固定させる
	- フッター
	    - 画面下部に固定表示する
	    - 中央に「表示切り替え」と「ゴミ箱を見る」リンクを配置する
	- 表示切り替え
		- 「すべて」、「メモ」、「TODOリスト」の3つのボタンで構成する

## 投稿エディタ

- テキスト入力フィールドを設置
- 入力欄の下に、左から順に以下のUIを配置する
    - チェックボックス（カテゴリ）
	    - 「メモ」「TODOリスト」の2種類を持つ
	    - 初期値は「メモ」
    - クリアボタン
	    - 押下すると入力した内容が消える
	- 保存ボタン
	    - 新規投稿時はラベルを「保存」、編集時はラベルを「更新」とする
	    - 押下時、いずれかのカテゴリを付けて投稿を保存する
	    - 保存完了後は以下の状態にする
        - エディタの入力内容をクリアする
        - 再びエディタにフォーカスを当てる
        - 「保存しました」または「更新しました」といったフィードバックメッセージを表示する
        - カテゴリを変更した場合、表示内容が新しいカテゴリに合わせて切り替わる
	    - エディタが空の場合は保存を行わず、Alertで未入力であることを通知する
	- キャンセルボタン
		- 既存投稿の編集時のみ表示する
		- 押下すると編集状態から通常表示に戻る
		- 新規投稿用エディタを表示する

## 投稿一覧

- 直近n件を表示する（初期値は10アイテム）
- 投稿の並び順の初期値は更新日時の降順（新しいものが上） 
- UIの先頭にソート機能ボタンをグループごとに設置
	- G1: 更新順、投稿順、手動並び替え順
	- G2: 昇順、降順、
- 投稿並び替え機能がある
	- 上移動ボタン・下移動ボタン押下で上下にひとつ移動
	- ポインティングデバイス用: ドラッグ&ドロップで好きな位置に移動

## 投稿一覧 個別投稿

- 各投稿の表示要素
	- 所属するカテゴリ（メモ／TODO）
    - 投稿日
    - 更新日
    - 投稿本文
    - ゴミ箱アイコン
	    - 押下すると一覧から表示が消える
    - 編集ボタン
		- 押下すると、その投稿の表示領域をエディタに差し替える。
		- 差し替わったエディタ内にはその投稿の内容が表示され、編集可能状態になっている。
		- 編集用エディタにはカテゴリチェックボックス、キャンセルボタン、更新ボタンを表示する
	- 上移動ボタン・下移動ボタン
	- ポインティングデバイス且つ画面がmdサイズ以上の場合
		- 投稿左側にドラッグ&ドロップ用のツマミが表示させる

## ゴミ箱

- ゴミ箱には status が trashed の投稿を表示する
- ゴミ箱表示画面では、通常の投稿一覧と同じレイアウトの一覧コンポーネントを利用する
- ゴミ箱内一覧を表示していても、通常の投稿一覧のキャッシュ状態は保持する（元の一覧画面に戻ったときに状態を復元できる）
- ゴミ箱一覧の上部に以下のインターフェースを配置する
    - 「表示されている投稿を選択」チェックボックス
        - チェックを入れると、現在表示されている投稿すべてにチェックを付ける
        - チェック状態ではラベルを「n件選択中」のように切り替える
        - チェック状態のときのみ「選択した投稿を削除」ボタンを表示する
    - 「選択した投稿を削除」ボタン
        - 押下で削除確認モーダルを開く
        - モーダルで「n件の投稿を完全に削除しますか?」とメッセージを表示する
    - 「ごみ箱を空にする」ボタン
        - 押下で削除確認モーダルを開く
        - モーダルで「ゴミ箱内のすべての投稿を完全に削除しますか？」とメッセージを表示する
        - 対象はロード済み／未ロードを問わず、status が trashed の投稿すべてとする
- 削除確認モーダル
    - 確認メッセージ（例：n件の投稿を完全に削除しますか?）
    - 警告メッセージ（この操作は取り消せません）
    - キャンセルボタン：モーダルを閉じる
    - 削除ボタン：対象の投稿を完全に削除し、「投稿を削除しました」トーストを表示する
- ゴミ箱内の各投稿の要素
    - 選択用チェックボックス
        - チェック状態に応じてラベルを「n件選択中」に更新する
    - 復元ボタン
        - 押下で status を active に変更し、ゴミ箱一覧からは非表示にする
    - 削除ボタン
        - 押下でその投稿を完全削除し、「投稿を削除しました」トーストを表示する


## エラーハンドリング仕様

- 各機能実行時には適切なエラーハンドリングを行い、必要に応じてユーザーにフィードバックする
- ユーザー向けの主なエラー種別と表示例
    - 認証エラー
    - 認可エラー
    - Not Found エラー
    - バリデーションエラー
    - サーバーエラー
    - 一般的なエラー
    - 成功メッセージ
- エラーや成功メッセージはトーストなどで表示し、ユーザーが現在の状態を理解できるようにする
- 開発環境では、次のような URL にアクセスすると対応するメッセージを表示できるようにする（例）
    - `http://localhost:3000/?errorTest=auth` → 認証エラー
    - `http://localhost:3000/?errorTest=authorization` → 認可エラー
    - `http://localhost:3000/?errorTest=notfound` → Not Found エラー
    - `http://localhost:3000/?errorTest=validation` → バリデーションエラー
    - `http://localhost:3000/?errorTest=server` → サーバーエラー
    - `http://localhost:3000/?errorTest=generic` → 一般的なエラー
    - `http://localhost:3000/?errorTest=success` → 成功メッセージ
- エラー／成功トースト表示後は、リロードで再発火しないように、URL から `?errorTest=...` を取り除く

## 将来機能一覧

- 投稿一覧のソート機能
    - 投稿日／更新日、昇順／降順で並び替えできる
- アカウント削除
    - ユーザーデータの削除とセッション終了を行い、「アカウントが削除されました（またのご利用をお待ちしております）」といったメッセージとトップページへのリンクを表示する
- タグ機能
    - 投稿保存時にタグ情報を紐づける
    - タグの初期値は null
    - ユーザーがタグの追加／削除／ラベル編集を行える
- 外観変更
    - システム設定／ライト／ダークの外観切り替え
    - 文字サイズ変更
- 投稿エクスポート機能
    - 投稿の追加・削除・ラベル変更を含めたエクスポート手段を検討する（詳細は今後検討）
- カスタムタグ機能
    - ユーザーが任意のタグを追加・編集・削除できる
    - カスタムタグ削除時、そのタグが付いていた投稿は「タグ未登録」とする
    - タグ削除は破壊的操作のため、削除時に確認アラートを表示する
- 投稿自動削除
    - ゴミ箱投入日から一定日数が経過した投稿を自動削除する
- 検索機能（テキスト検索）
    - 検索フィールドに文字列を入力し、検索ボタン押下で検索を実行する
    - タイトル、投稿本文、カテゴリ、タグのいずれかに検索文字列を含む投稿を一覧で表示する

## 非機能要件 / 品質保証

- 日常の開発ではスタブ認証・スタブCRUDを用いて UI／ロジックを素早く検証する。
- 本番と同等の構成（Auth.js + 本番想定DB）での統合テスト・E2Eテストを、専用の test / stg 環境で実施し、認証および CRUD の正常系・異常系を確認する。
